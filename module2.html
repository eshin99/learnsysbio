<!DOCTYPE html>
<!-- Learn Systems Biology by Yong-Jun Shin (csml.uconn.edu), 2016
     Module 2: Simple Gene Network -->

    <head>
        <!-- Cascading Style Sheet (CSS) for the sidebar menu-->
        <link rel="stylesheet" href="css/menu.css">
        <!-- Cascading Style Sheet (CSS) for the simulation layout-->
        <link rel="stylesheet" href="css/sim.css">
        <!-- bootstrap.css http://getbootsrap.com -->
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <!-- w3.css http://www.w3schools.com/w3css/ -->
        <link rel="stylesheet" href="css/w3.css">
        <!-- jquery https://jquery.com -->
        <script src="js/jquery.min.js"></script>
        <!-- bootstrap.js http://getbootsrap.com -->
        <script src="js/bootstrap.min.js"></script>
        <!-- ace.js: an embeddable code editor written in JavaScript https://ace.c9.io -->
        <script src="js/ace.js"></script>
        <!-- pltly.js: the open source JavaScript graphing library https://plot.ly/javascript -->
        <script src="js/plotly.min.js"></script>
    </head>

    <body>
        <!-- Sidebar Menu -->
        <div id="wrapper">
            <div id="sidebar-wrapper">
                <ul class="sidebar-nav w3-large">
                    <li class="sidebar-brand ">
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="module1.html">Module 1</a>
                    </li>
                    <li>
                        <a href="module2.html">Module 2</a>
                    </li>
                    <li>
                        <a href="module3.html">Module 3</a>
                    </li>
                    <li>
                        <a href="module4.html">Module 4</a>
                    </li>
                    <li>
                        <a href="module5.html">Module 5</a>
                    </li>
                    <li>
                        <a href="module6.html">Module 6</a>
                    </li>
                    <li>
                        <a href="module7.html">Module 7</a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Title -->
        <div id = "header" class="container">
            <h3><b>Module 1: Simple Gene Network (Gene X Activates Gene Y)</b></h3>
            <h4>Learn Systems Biology <font color="#a9a9a9"> by UCONN CSMLab </font> <a href="http://csml.uconn.edu"><i class="w3-medium glyphicon glyphicon-home"></i></a></h4>
        </div>

        <!-- User interface -->
        <button id ="run" class="w3-btn w3-ripple w3-teal w3-large" onclick="run()">Run</button>
        <div id = "checkbox">
            <input id = "xProtein" class="w3-check" type="checkbox" checked="checked" >
            <label class="w3-medium ">Show x protein</label> <br>
            <input id = "yProtein" class="w3-check" type="checkbox" checked="checked">
            <label class="w3-medium">Show y protein</label><br>
            <input id = "hold" class="w3-check" type="checkbox">
            <label class="w3-medium">Hold</label>
        </div>
        <div id = "guide">
            <p  class = "w3-large" >Modify the code below and press [Run]</p>
        </div>

        <!-- Chart -->
        <div id="chart"></div>

        <!-- Code editor with default text -->
        <div id="editor">
            N = 100;                      // total number of data points
            x = new Array(N);             // x protein concentration (uM)
            y = new Array(N);             // y protein concentration (uM)
            X = 10;                       // constant x protein concentration
            x[0] = X;                     // initial x protein concentration
            y[0] = 0;                     // initial y protein concentration
            p1 = 0.4;                     // production parameter
            p2 = 0.7;                     // degradation/dilution parameter

            for (n = 1; n < N; n++)           // N-1 loops (1 loop = 1 min)
            {
            x[n] = X;                     // constant x protein concentration
            y[n] = p1*x[n-1] + p2*y[n-1]; // updated y protein concentration
            }                                 // end of for loop
        </div>

        <!-- Code editor with default text -->
        <script>
            var editor = ace.edit("editor");
            editor.setTheme("ace/theme/eclipse");
            editor.getSession().setMode("ace/mode/javascript");
            editor.setFontSize(16);

            // Execute when [Run] is clicked
            $( "#run" ).click(function() {
                var chart = document.getElementById('chart');
                var code = editor.getValue();
                eval(code);

                xData = {name: "x protein", x: n, y: x};
                yData = {name: "y protein", x: n, y: y};
                data = [];
                if (document.getElementById('xProtein').checked) {
                    data.push (xData);
                }
                if (document.getElementById('yProtein').checked) {
                    data.push (yData);
                }
                layout = {
                    xaxis: {title: 'time [min]'},
                    yaxis: {title: 'protein concentration [uM]'},
                    margin: {t: 40},
                };

                if (document.getElementById('hold').checked) {
                    Plotly.plot(chart, data, layout);
                } else {
                    Plotly.newPlot(chart, data, layout);
                }
            });
        </script>
    </body>
</html>
